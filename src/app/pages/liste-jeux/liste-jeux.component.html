<div class="container mt-4">
  <h2>Trophées potentiels jeux PS4/PS5</h2>
  <div class="table-responsive">
    <table class="table table-bordered text-center mb-0">
      <thead>
        <tr>
          <th colspan="2" style="background-color: #008080; color: white; text-align: center;">NIVEAU ACTUEL</th>
          <th style="background-color: #008080; color: white; text-align: center;">PLATINE</th>
          <th style="background-color: #008080; color: white; text-align: center;">OR</th>
          <th style="background-color: #008080; color: white; text-align: center;">ARGENT</th>
          <th style="background-color: #008080; color: white; text-align: center;">BRONZE</th>
          <th style="background-color: #008080; color: white; text-align: center;">TOTAL</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="font-weight: bold; text-align: center; vertical-align: middle; font-size: 15px;" colspan="2">
            <img src="spritePsnOr.png" alt="icone-trophee" style="width: 30px; height: 30px;">
            {{ niveauActuel }}
          </td>
          <td style="font-weight: bold; text-align: center; vertical-align: middle; font-size: 15px;">
            <img src="platinePsn.png" alt="icone-trophee" style="width: 30px; height: 30px;">
            {{ tropheesActuels.nbPlatine }}
          </td>
          <td style="font-weight: bold; text-align: center; vertical-align: middle; font-size: 15px;">
            <img src="orPsn.png" alt="icone-trophee" style="width: 30px; height: 35px;">
            {{ tropheesActuels.nbOr }}
          </td>
          <td style="font-weight: bold; text-align: center; vertical-align: middle; font-size: 15px;">
            <img src="argentPsn.png" alt="icone-trophee" style="width: 30px; height: 35px;">
            {{ tropheesActuels.nbArgent }}
          </td>
          <td style="font-weight: bold; text-align: center; vertical-align: middle; font-size: 15px;">
            <img src="bronzePsn.png" alt="icone-trophee" style="width: 28px; height: 35px;">
            {{ tropheesActuels.nbBronze }}
          </td>
          <td style="font-weight: bold; text-align: center; vertical-align: middle; font-size: 15px;">
            {{ tropheesActuels.total }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="d-flex align-items-start mt-3">

    <app-boutons-navigation></app-boutons-navigation>

    @if (jeuxList.length > 0) {
      <!-- Tableau à droite -->
      <div class="flex-grow-1">
        <table class="table table-bordered table-striped">
          <thead>
            <tr>
              <th style="background-color: #008080; color: white; text-align: center;">Jeu</th>
              <th style="background-color: #008080; color: white; text-align: center;">Plateforme</th>
              <th style="background-color: #008080; color: white; text-align: center;">Action</th>
              <th style="background-color: #008080; color: white; text-align: center;">Heures</th>
              <th style="background-color: #008080; color: white; text-align: center;">Platine</th>
              <th style="background-color: #008080; color: white; text-align: center;">Or</th>
              <th style="background-color: #008080; color: white; text-align: center;">Argent</th>
              <th style="background-color: #008080; color: white; text-align: center;">Bronze</th>
              <th style="background-color: #008080; color: white; text-align: center;">Total</th>
            </tr>
          </thead>
          <tbody>
            @for (jp of jeuxList; track $index) {
              <tr>
                <td style="background-color: #008080; color: white;">{{ jp.jeu }}</td>
                <td>{{ jp.plateforme.plateforme }}</td>
                <td>
                  <button class="update">
                    <i class="fa-solid fa-pen-nib"></i>
                  </button>
                  <button class="delete">
                    <i class="fa-solid fa-trash"></i>
                  </button>
                </td>
                <td>{{ jp.nbHeures }}</td>
                <td>{{ jp.nbPlatine }}</td>
                <td>{{ jp.nbOr }}</td>
                <td>{{ jp.nbArgent }}</td>
                <td>{{ jp.nbBronze }}</td>
                <td>{{ calculateTotal(jp) }}</td>
              </tr>
            }
            @if (currentPage === pageNumbers.length) {
              <tr style="font-weight: bold;">
                <td colspan="3" style="background-color: #008080; color: white; text-align: center;">Total</td>
                <td style="background-color: #008080; color: white; text-align: center;">{{ calculateTotalHeures() }}</td>
                <td style="background-color: #008080; color: white; text-align: center;">{{ calculateTotalPlatine() }}</td>
                <td style="background-color: #008080; color: white; text-align: center;">{{ calculateTotalOr() }}</td>
                <td style="background-color: #008080; color: white; text-align: center;">{{ calculateTotalArgent() }}</td>
                <td style="background-color: #008080; color: white; text-align: center;">{{ calculateTotalBronze() }}</td>
                <td style="background-color: #008080; color: white; text-align: center;">{{ calculateTotalTrophees() }}</td>
              </tr>
              <tr style="font-weight: bold;">
                <td colspan="4" style="background-color: #008080; color: white; text-align: center;">Total Actuel</td>
                <td style="background-color: #008080; color: white; text-align: center;">{{ tropheesActuels.nbPlatine }}</td>
                <td style="background-color: #008080; color: white; text-align: center;">{{ tropheesActuels.nbOr }}</td>
                <td style="background-color: #008080; color: white; text-align: center;">{{ tropheesActuels.nbArgent }}</td>
                <td style="background-color: #008080; color: white; text-align: center;">{{ tropheesActuels.nbBronze }}</td>
                <td style="background-color: #008080; color: white; text-align: center;">{{ tropheesActuels.total }}</td>
              </tr>
              <tr style="font-weight: bold;">
                <td colspan="4" style="background-color: #008080; color: white; text-align: center;">
                  Total Potentiel
                </td>
                <td style="background-color: #008080; color: white; text-align: center;">
                  {{ getTotalCumulTrophees().platine }}
                </td>
                <td style="background-color: #008080; color: white; text-align: center;">
                  {{ getTotalCumulTrophees().or }}
                </td>
                <td style="background-color: #008080; color: white; text-align: center;">
                  {{ getTotalCumulTrophees().argent }}
                </td>
                <td style="background-color: #008080; color: white; text-align: center;">
                  {{ getTotalCumulTrophees().bronze }}
                </td>
                <td style="background-color: #008080; color: white; text-align: center;">
                  {{ getTotalCumulTrophees().total }}
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>
    }
  </div>

  <div style="display: flex; justify-content: center; margin-top: 15px;">
    <button class="btn add" (click)="openAddModal()">Ajouter</button>
  </div>

  @if (allJeuxList.length > 5) {
    <app-pagination
      [currentPage]="currentPage"
      [totalPages]="pageNumbers.length"
      (pageChange)="goToPage($event)"
    ></app-pagination>
  }

  @if (isAddModalOpen) {
    <div class="modal">
      <div class="modal-overlay">
        <app-jeux-plateforme-form
          (close)="closeModal()"
          (jeuCree)="refresh()"
        ></app-jeux-plateforme-form>
      </div>
    </div>
  }

</div>
